import{u as j,_ as I,a as M}from"./C993WRrC.js";import{f as g,o as u,c as _,a as h,j as y,k as T,l as b,m as B,g as J,h as K,b as s,w as e,q as N,F as z,s as D,v as q,d as a,x as H,t as v}from"./B6bR7jV_.js";import"./gbvU9_Ei.js";import"./laS13Kiw.js";import"./DlAUqK2U.js";import"./Bc-ZmqPf.js";const O={class:"relative w-full overflow-auto"},P=g({__name:"Table",props:{class:{}},setup(p){const o=p;return(c,$)=>(u(),_("div",O,[h("table",{class:T(b(B)("w-full caption-bottom text-sm",o.class))},[y(c.$slots,"default")],2)]))}}),Q=g({__name:"TableBody",props:{class:{}},setup(p){const o=p;return(c,$)=>(u(),_("tbody",{class:T(b(B)("[&_tr:last-child]:border-0",o.class))},[y(c.$slots,"default")],2))}}),W=g({__name:"TableCell",props:{class:{}},setup(p){const o=p;return(c,$)=>(u(),_("td",{class:T(b(B)("p-4 align-middle [&:has([role=checkbox])]:pr-0",o.class))},[y(c.$slots,"default")],2))}}),X=g({__name:"TableHead",props:{class:{}},setup(p){const o=p;return(c,$)=>(u(),_("th",{class:T(b(B)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",o.class))},[y(c.$slots,"default")],2))}}),Y=g({__name:"TableHeader",props:{class:{}},setup(p){const o=p;return(c,$)=>(u(),_("thead",{class:T(b(B)("[&_tr]:border-b",o.class))},[y(c.$slots,"default")],2))}}),Z=g({__name:"TableRow",props:{class:{}},setup(p){const o=p;return(c,$)=>(u(),_("tr",{class:T(b(B)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",o.class))},[y(c.$slots,"default")],2))}}),ee={class:"flex flex-col gap-7"},te={key:0,class:"grid grid-cols-2 gap-3 container overflow-x-auto"},se={key:1,class:"flex flex-col gap-3 container mx-auto overflow-x-auto"},pe=g({__name:"backside",setup(p){const o=J(),c=K(),{data:$,error:ae,refresh:le}=j("get_admin",async()=>{const{data:i,error:t}=await o.from("admin").select("*").eq("id",c.value.id);return t?null:i[0]}),{data:E,error:ne,refresh:S}=j("get_data",async()=>{const{data:i,error:t}=await o.from("seat").select("*, app_user(*)").order("number",{ascending:!0});if(t)return null;let k=[];const l=[];for(let d=1;d<=16;d++){for(let C=0;C<i.length;C++)i[C].group===d&&k.push(i[C]);l.push(k),k=[]}return l}),x=async i=>{console.log(i);const{data:t,error:k}=await o.from("seat").update({status:"available"}).eq("group",i);k?q({title:"未知的錯誤！開啟組別尚未完成，請聯繫工作人員！",variant:"destructive"}):(q({title:"已開啟第"+i+"組的座位!"}),await S())},w=async i=>{console.log(i);const{data:t,error:k}=await o.from("seat").update({status:"lock"}).eq("group",i);k?q({title:"未知的錯誤！鎖定組別尚未完成，請聯繫工作人員！",variant:"destructive"}):(q({title:"已鎖定第"+i+"組的座位!"}),await S())};return(i,t)=>{const k=M,l=I,d=X,C=Z,F=Y,m=W,G=Q,R=P;return u(),_("div",ee,[s(k,{class:"px-2 md:px-4 sticky top-4 z-20"}),b($)?(u(),_("div",te,[s(l,{onClick:t[0]||(t[0]=n=>x(7)),variant:"outline"},{default:e(()=>[a("開啟第七組")]),_:1}),s(l,{onClick:t[1]||(t[1]=n=>w(7)),variant:"destructive"},{default:e(()=>[a("關閉第七組")]),_:1}),s(l,{onClick:t[2]||(t[2]=n=>x(8)),variant:"outline"},{default:e(()=>[a("開啟第八組")]),_:1}),s(l,{onClick:t[3]||(t[3]=n=>w(8)),variant:"destructive"},{default:e(()=>[a("關閉第八組")]),_:1}),s(l,{onClick:t[4]||(t[4]=n=>x(9)),variant:"outline"},{default:e(()=>[a("開啟第九組")]),_:1}),s(l,{onClick:t[5]||(t[5]=n=>w(9)),variant:"destructive"},{default:e(()=>[a("關閉第九組")]),_:1}),s(l,{onClick:t[6]||(t[6]=n=>x(10)),variant:"outline"},{default:e(()=>[a("開啟第十組")]),_:1}),s(l,{onClick:t[7]||(t[7]=n=>w(10)),variant:"destructive"},{default:e(()=>[a("關閉第十組")]),_:1}),s(l,{onClick:t[8]||(t[8]=n=>x(11)),variant:"outline"},{default:e(()=>[a("開啟第十一組")]),_:1}),s(l,{onClick:t[9]||(t[9]=n=>w(11)),variant:"destructive"},{default:e(()=>[a("關閉第十一組")]),_:1}),s(l,{onClick:t[10]||(t[10]=n=>x(12)),variant:"outline"},{default:e(()=>[a("開啟第十二組")]),_:1}),s(l,{onClick:t[11]||(t[11]=n=>w(12)),variant:"destructive"},{default:e(()=>[a("關閉第十二組")]),_:1}),s(l,{onClick:t[12]||(t[12]=n=>x(13)),variant:"outline"},{default:e(()=>[a("開啟第十三組")]),_:1}),s(l,{onClick:t[13]||(t[13]=n=>w(13)),variant:"destructive"},{default:e(()=>[a("關閉第十三組")]),_:1}),s(l,{onClick:t[14]||(t[14]=n=>x(14)),variant:"outline"},{default:e(()=>[a("開啟第十四組")]),_:1}),s(l,{onClick:t[15]||(t[15]=n=>w(14)),variant:"destructive"},{default:e(()=>[a("關閉第十四組")]),_:1})])):N("",!0),b($)?(u(),_("div",se,[(u(!0),_(z,null,D(b(E),(n,U)=>(u(),_("div",{key:U},[n[0].group!==15&&n[0].group!==16?(u(),H(R,{key:0,class:"w-[1300px]"},{default:e(()=>[s(F,null,{default:e(()=>[s(C,null,{default:e(()=>[s(d,{class:"w-[50px]"},{default:e(()=>[a("組別")]),_:1}),s(d,{class:"w-[80px]"},{default:e(()=>[a("座位號碼")]),_:1}),s(d,{class:"w-[80px]"},{default:e(()=>[a("座位狀態")]),_:1}),s(d,{class:"w-[80px]"},{default:e(()=>[a("本名")]),_:1}),s(d,{class:"w-[250px]"},{default:e(()=>[a("Email")]),_:1}),s(d,{class:"w-[100px]"},{default:e(()=>[a("手機")]),_:1}),s(d,{class:"w-[200px]"},{default:e(()=>[a("學校/科系")]),_:1}),s(d,{class:"w-[100px]"},{default:e(()=>[a("綽號")]),_:1}),s(d,{class:"w-[80px]"},{default:e(()=>[a("MBTI")]),_:1})]),_:1})]),_:1}),s(G,null,{default:e(()=>[(u(!0),_(z,null,D(n,(f,A)=>(u(),H(C,{key:A},{default:e(()=>{var V;return[s(m,{class:""},{default:e(()=>[a(v(f.group),1)]),_:2},1024),s(m,null,{default:e(()=>[a(v(f.number),1)]),_:2},1024),s(m,null,{default:e(()=>[a(v(f.status),1)]),_:2},1024),s(m,null,{default:e(()=>{var r;return[a(v((r=f.app_user)==null?void 0:r.name),1)]}),_:2},1024),s(m,{class:""},{default:e(()=>{var r;return[a(v((r=f.app_user)==null?void 0:r.email),1)]}),_:2},1024),s(m,null,{default:e(()=>{var r;return[a(v((r=f.app_user)==null?void 0:r.phone),1)]}),_:2},1024),(V=f.app_user)!=null&&V.school?(u(),H(m,{key:0},{default:e(()=>{var r,L;return[a(v((r=f.app_user)==null?void 0:r.school)+" / "+v((L=f.app_user)==null?void 0:L.department),1)]}),_:2},1024)):(u(),H(m,{key:1})),s(m,null,{default:e(()=>{var r;return[a(v((r=f.app_user)==null?void 0:r.nick_name),1)]}),_:2},1024),s(m,null,{default:e(()=>{var r;return[a(v((r=f.app_user)==null?void 0:r.mbti),1)]}),_:2},1024)]}),_:2},1024))),128))]),_:2},1024)]),_:2},1024)):N("",!0)]))),128))])):N("",!0)])}}});export{pe as default};
