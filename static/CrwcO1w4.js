import{_ as U,a as W,u as A,b as X}from"./CaW_RgJT.js";import M from"./DQmj9oeJ.js";import{f as k,x as H,o as u,j as y,w as t,k as T,l as N,m as O,q as e,z as J,N as V,K as Q,c as $,s as q,v as S,y as R,B as E,A as G,C as Y,D as Z,b as a,E as ee,F as se,X as ae,G as re,a as l,g as L,d as f,n as te,t as w,H as I,I as oe,r as le,h as ne,i as ue}from"./Ng1zLtWP.js";import"./6nzt8NSm.js";import"./0D-gZBwi.js";import"./DlAUqK2U.js";const de=k({__name:"Dialog",props:{open:{type:Boolean},defaultOpen:{type:Boolean},modal:{type:Boolean}},emits:["update:open"],setup(c,{emit:s}){const x=H(c,s);return(r,n)=>(u(),y(e(J),N(O(e(x))),{default:t(()=>[T(r.$slots,"default")]),_:3},16))}}),_e=k({__name:"DialogClose",props:{asChild:{type:Boolean},as:{}},setup(c){const s=c;return(d,o)=>(u(),y(e(V),N(O(s)),{default:t(()=>[T(d.$slots,"default")]),_:3},16))}}),ie=k({__name:"DialogTrigger",props:{asChild:{type:Boolean},as:{}},setup(c){const s=c;return(d,o)=>(u(),y(e(Q),N(O(s)),{default:t(()=>[T(d.$slots,"default")]),_:3},16))}}),pe=k({__name:"DialogHeader",props:{class:{}},setup(c){const s=c;return(d,o)=>(u(),$("div",{class:q(e(S)("flex flex-col gap-y-1.5 text-center sm:text-left",s.class))},[T(d.$slots,"default")],2))}}),fe=k({__name:"DialogTitle",props:{asChild:{type:Boolean},as:{},class:{}},setup(c){const s=c,d=R(()=>{const{class:x,...r}=s;return r}),o=E(d);return(x,r)=>(u(),y(e(Y),G(e(o),{class:e(S)("text-lg font-semibold leading-none tracking-tight",s.class)}),{default:t(()=>[T(x.$slots,"default")]),_:3},16,["class"]))}}),ce=k({__name:"DialogDescription",props:{asChild:{type:Boolean},as:{},class:{}},setup(c){const s=c,d=R(()=>{const{class:x,...r}=s;return r}),o=E(d);return(x,r)=>(u(),y(e(Z),G(e(o),{class:e(S)("text-sm text-muted-foreground",s.class)}),{default:t(()=>[T(x.$slots,"default")]),_:3},16,["class"]))}}),he=l("span",{class:"sr-only"},"Close",-1),me=k({__name:"DialogContent",props:{forceMount:{type:Boolean},trapFocus:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(c,{emit:s}){const d=c,o=s,x=R(()=>{const{class:n,...m}=d;return m}),r=H(x,o);return(n,m)=>(u(),y(e(re),null,{default:t(()=>[a(e(ee),{class:"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"}),a(e(se),G(e(r),{class:e(S)("fixed left-1/2 top-1/2 z-50 grid w-full max-w-lg -translate-x-1/2 -translate-y-1/2 gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",d.class)}),{default:t(()=>[T(n.$slots,"default"),a(e(V),{class:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground"},{default:t(()=>[a(e(ae),{class:"w-4 h-4"}),he]),_:1})]),_:3},16,["class"])]),_:3}))}}),ye=k({__name:"DialogFooter",props:{class:{}},setup(c){const s=c;return(d,o)=>(u(),$("div",{class:q(e(S)("flex flex-col-reverse sm:flex-row sm:justify-end sm:gap-x-2",s.class))},[T(d.$slots,"default")],2))}}),ge={class:"grid gap-4 py-4"},ve={class:"grid gap-4 py-4"},we=l("span",{class:"w-full"},"透過 Google 登入",-1),xe={class:"flex flex-col text-xs"},be={class:"flex flex-col text-xs"},ke=k({__name:"reservation_button",props:{data:{},user:{},your_seat:{},data_refresh:{type:Function},personal_refresh:{type:Function}},setup(c){const s=L(),d=c;async function o(r,n,m){await s.from("seat").upsert({group:r,number:n,user_id:m,status:"taken"}),oe({title:"已送出預約資料!"}),await d.data_refresh(),await d.personal_refresh()}const x={async loginWithGoogle(){const r=le("localhost:3000");window.location.host==="localhost:3000"?r.value="localhost:3000":r.value="bearyep.github.io/STP_Reservation/",console.log(r),await s.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.protocol+"//bearyep.github.io/STP_Reservation//auth/callback"}})}};return(r,n)=>{var K;const m=U,h=ie,_=fe,F=pe,i=me,b=ce,g=W,D=_e,B=ye,p=M,P=de;return u(),$("div",null,[r.data.status==="available"?(u(),y(P,{key:0},{default:t(()=>{var C;return[a(h,null,{default:t(()=>[a(m,{class:"rounded-full h-[40px] w-[75px]",variant:"outline"},{default:t(()=>[f(" 可預約 ")]),_:1})]),_:1}),((C=r.user)==null?void 0:C.first_time)===!0?(u(),y(i,{key:0,class:"sm:max-w-[425px]"},{default:t(()=>[a(F,null,{default:t(()=>[a(_,null,{default:t(()=>[f("請先填寫資料。")]),_:1})]),_:1}),a(m,{onClick:n[0]||(n[0]=v=>("navigateTo"in r?r.navigateTo:e(te))("/profile_edit"))},{default:t(()=>[f(" 個人資料編輯 ")]),_:1})]),_:1})):r.your_seat&&r.your_seat[0]?(u(),y(i,{key:1,class:"sm:max-w-[425px]"},{default:t(()=>[a(F,null,{default:t(()=>[a(_,null,{default:t(()=>[f("您已預約位置")]),_:1}),a(b,null,{default:t(()=>[f(" 以下為您的預約資料。 ")]),_:1})]),_:1}),l("div",ge,[a(g,null,{default:t(()=>[f(" 位置：第 "+w(r.your_seat[0].group)+" 組 - "+w(r.your_seat[0].number),1)]),_:1}),a(g,null,{default:t(()=>[f(" 綽號："+w(r.your_seat[0].app_user.nick_name),1)]),_:1}),a(g,null,{default:t(()=>[f(" MBTI："+w(r.your_seat[0].app_user.mbti),1)]),_:1})]),a(B,null,{default:t(()=>[a(D,{"as-child":""},{default:t(()=>[a(m,{variant:"outline"},{default:t(()=>[f(" 關閉 ")]),_:1})]),_:1})]),_:1})]),_:1})):r.user?(u(),y(i,{key:2,class:"sm:max-w-[425px]"},{default:t(()=>[a(F,null,{default:t(()=>[a(_,null,{default:t(()=>[f("確認要預約這個座位嗎?")]),_:1}),a(b,null,{default:t(()=>[f(" 請確認以下的資料，送出後無法更改。 ")]),_:1})]),_:1}),l("div",ve,[a(g,null,{default:t(()=>[f(" 位置：第 "+w(r.data.group)+" 組 - "+w(r.data.number),1)]),_:1}),a(g,null,{default:t(()=>{var v;return[f(" 綽號："+w((v=r.user)==null?void 0:v.nick_name),1)]}),_:1}),a(g,null,{default:t(()=>{var v;return[f(" MBTI："+w((v=r.user)==null?void 0:v.mbti),1)]}),_:1})]),a(B,null,{default:t(()=>[a(D,{"as-child":""},{default:t(()=>[a(m,{onClick:n[1]||(n[1]=v=>{o(r.data.group,r.data.number,r.user.id)}),class:"bg-green-500 text-white px-4 py-1 rounded"},{default:t(()=>[f(" 確認 ")]),_:1})]),_:1}),a(D,{"as-child":""},{default:t(()=>[a(m,{variant:"outline"},{default:t(()=>[f(" 關閉 ")]),_:1})]),_:1})]),_:1})]),_:1})):(u(),y(i,{key:3,class:"sm:max-w-[425px]"},{default:t(()=>[a(F,null,{default:t(()=>[a(_,null,{default:t(()=>[f("請先登入。")]),_:1})]),_:1}),a(m,{variant:"outline",onClick:x.loginWithGoogle},{default:t(()=>[a(p,{name:"devicon:google"}),we]),_:1},8,["onClick"])]),_:1}))]}),_:1})):I("",!0),r.data.user_id===((K=r.user)==null?void 0:K.id)?(u(),y(m,{key:1,class:"bg-green-600 text-white px-4 py-1 rounded-full h-[40px] w-[75px]",disabled:""},{default:t(()=>{var C,v,j,z;return[l("div",xe,[l("div",null,w((C=r.data.app_user)!=null&&C.nick_name?(v=r.data.app_user)==null?void 0:v.nick_name:"無"),1),l("div",null,w((j=r.data.app_user)!=null&&j.mbti?(z=r.data.app_user)==null?void 0:z.mbti:"無"),1)])]}),_:1})):r.data.status==="taken"?(u(),y(m,{key:2,class:"bg-sky-800 rounded-full h-[40px] w-[75px]",disabled:""},{default:t(()=>{var C,v,j,z;return[l("div",be,[l("div",null,w((C=r.data.app_user)!=null&&C.nick_name?(v=r.data.app_user)==null?void 0:v.nick_name:"無"),1),l("div",null,w((j=r.data.app_user)!=null&&j.mbti?(z=r.data.app_user)==null?void 0:z.mbti:"無"),1)])]}),_:1})):r.data.status==="lock"?(u(),y(m,{key:3,variant:"secondary",class:"rounded-full h-[40px] w-[75px] bg-white",disabled:""})):I("",!0)])}}}),$e={class:"flex flex-col gap-3 w-[300px]"},De={class:"flex flex-row justify-center gap-3"},Be={class:"flex flex-col gap-3"},Ce={key:0,class:"w-[150px] border-2 flex place-content-center place-items-center"},Te={key:1,class:"w-[150px] flex place-content-center place-items-center"},Pe={class:"flex flex-col gap-3"},Fe={class:"flex flex-row justify-center gap-3"},je=k({__name:"group_table",props:{user:{},list:{},your_seat:{},data_refresh:{type:Function},personal_refresh:{type:Function}},setup(c){return(s,d)=>{const o=ke;return u(),$("div",$e,[l("div",De,[l("div",Be,[a(o,{user:s.user,data:s.list[0],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"]),a(o,{user:s.user,data:s.list[1],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"])]),s.list[0].status!=="lock"?(u(),$("div",Ce,"第"+w(s.list[0].group)+"組",1)):(u(),$("div",Te)),l("div",Pe,[a(o,{user:s.user,data:s.list[2],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"]),a(o,{user:s.user,data:s.list[3],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"])])]),l("div",Fe,[a(o,{user:s.user,data:s.list[4],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"]),a(o,{user:s.user,data:s.list[5],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"]),a(o,{user:s.user,data:s.list[6],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"])])])}}}),ze={class:"flex flex-col gap-7"},Se={class:"container mx-auto px-4 flex flex-col gap-2"},Ae=l("div",null,[l("div",{class:"font-bold text-2xl"},"STP暑期黑馬營劃位"),l("div",{class:"text-gray-500"},"說明文字..."),l("img",{src:"https://images.plurk.com/5nmKlgKPdXuUiCcLjdLHvR.jpg",class:"w-[1364px]"})],-1),Ie=l("div",{class:"border-2 h-[1px]"},null,-1),Ne={class:"container mx-auto overflow-x-auto"},Oe={key:0,class:"flex flex-col gap-10"},Re={class:"flex flex-row w-[1225px]"},Ge={class:"flex flex-col w-[100px] h-[60px]"},Ke={class:"text-sm w-[100px] h-[20px]"},Me={class:"text-sm w-[100px] h-[20px]"},He={class:"text-sm w-[100px] h-[20px]"},Ve=l("div",{class:"flex flex-row gap-[50px] w-[1125px] justify-center"},[l("div",{class:"w-[350px] h-[60px] border-2 flex place-content-center place-items-center"},"投影幕"),l("div",{class:"w-[200px] h-[60px] border-2 flex place-content-center place-items-center"},"講台"),l("div",{class:"w-[350px] h-[60px] border-2 flex place-content-center place-items-center"},"投影幕")],-1),qe={class:"flex flex-row gap-10"},Ee={class:"flex flex-row gap-10"},Le={class:"flex flex-row gap-10"},Ue={key:0,class:"flex flex-row gap-10"},We={key:1,class:"flex h-[50px] justify-center gap-5 text-gray-600"},ss=k({__name:"index",setup(c){const s=L(),d=ne(),{data:o,error:x,refresh:r}=A("get_user",async()=>{const{data:b,error:g}=await s.from("app_user").select("*").eq("id",d.value.id);return g?null:b[0]}),{data:n,error:m,refresh:h}=A("get_data",async()=>{const{data:b,error:g}=await s.from("seat").select("*, app_user(*)").order("number",{ascending:!0});if(g)return null;let D=[];const B=[];for(let p=1;p<=16;p++){for(let P=0;P<b.length;P++)b[P].group===p&&D.push(b[P]);B.push(D),D=[]}return B}),{data:_,error:F,refresh:i}=A("get_personal_data",async()=>{const{data:b,error:g}=await s.from("seat").select("*, app_user(*)").eq("user_id",d.value.id);return g?null:b});return ue(async()=>{await r(),await h(),await i()}),(b,g)=>{const D=X,B=M,p=je;return u(),$("div",ze,[a(D,{class:"px-2 md:px-4 sticky top-4 z-20"}),l("div",Se,[Ae,Ie,l("div",Ne,[e(n)&&e(o)&&e(_)?(u(),$("div",Oe,[l("div",Re,[l("div",Ge,[l("div",Ke,[a(B,{name:"ph:circle",style:{color:"rgb(0 0 0 / 0.5)"}}),f(" ：可預約 ")]),l("div",Me,[a(B,{name:"ph:circle-duotone",style:{color:"rgb(22 163 74 / 0.5)"}}),f(" ：您的位置 ")]),l("div",He,[a(B,{name:"ph:circle-duotone",style:{color:"rgb(59 130 246 / 0.5)"}}),f(" ：已預約 ")])]),Ve]),l("div",qe,[a(p,{user:e(o),list:e(n)[0],data_refresh:e(h),personal_refresh:e(i),your_seat:e(_)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(p,{user:e(o),list:e(n)[1],data_refresh:e(h),personal_refresh:e(i),your_seat:e(_)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(p,{user:e(o),list:e(n)[2],data_refresh:e(h),personal_refresh:e(i),your_seat:e(_)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(p,{user:e(o),list:e(n)[3],data_refresh:e(h),personal_refresh:e(i),your_seat:e(_)},null,8,["user","list","data_refresh","personal_refresh","your_seat"])]),l("div",Ee,[a(p,{user:e(o),list:e(n)[4],data_refresh:e(h),personal_refresh:e(i),your_seat:e(_)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(p,{user:e(o),list:e(n)[5],data_refresh:e(h),personal_refresh:e(i),your_seat:e(_)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(p,{user:e(o),list:e(n)[6],data_refresh:e(h),personal_refresh:e(i),your_seat:e(_)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(p,{user:e(o),list:e(n)[7],data_refresh:e(h),personal_refresh:e(i),your_seat:e(_)},null,8,["user","list","data_refresh","personal_refresh","your_seat"])]),l("div",Le,[a(p,{user:e(o),list:e(n)[10],data_refresh:e(h),personal_refresh:e(i),your_seat:e(_)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(p,{user:e(o),list:e(n)[8],data_refresh:e(h),personal_refresh:e(i),your_seat:e(_)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(p,{user:e(o),list:e(n)[9],data_refresh:e(h),personal_refresh:e(i),your_seat:e(_)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(p,{user:e(o),list:e(n)[11],data_refresh:e(h),personal_refresh:e(i),your_seat:e(_)},null,8,["user","list","data_refresh","personal_refresh","your_seat"])]),e(n)[12][0].status!=="lock"?(u(),$("div",Ue,[a(p,{user:e(o),list:e(n)[14],data_refresh:e(h),personal_refresh:e(i),your_seat:e(_)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(p,{user:e(o),list:e(n)[12],data_refresh:e(h),personal_refresh:e(i),your_seat:e(_)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(p,{user:e(o),list:e(n)[13],data_refresh:e(h),personal_refresh:e(i),your_seat:e(_)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(p,{user:e(o),list:e(n)[15],data_refresh:e(h),personal_refresh:e(i),your_seat:e(_)},null,8,["user","list","data_refresh","personal_refresh","your_seat"])])):I("",!0)])):(u(),$("div",We,"請登入以查看預約列表及進行預約服務。"))])])])}}});export{ss as default};
