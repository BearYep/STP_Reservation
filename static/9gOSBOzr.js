import{_ as M}from"./E5bjv1Qy.js";import{_ as k}from"./DamKKj7V.js";import{j as R,k as y,r as C,s as z,l as G,m as H,q as I,v as j,x as N,y as F,z as u,A as U,B as W,f as K,g as L,h as $,C as q,o as m,c as g,F as J,D as Q,d as x,b as D,w,E,G as B,t as O,a as S,n as X}from"./kp6TFN3L.js";const Y=s=>s==="defer"||s===!1;function Z(...s){var V;const o=typeof s[s.length-1]=="string"?s.pop():void 0;typeof s[0]!="string"&&s.unshift(o);let[e,d,a={}]=s;if(typeof e!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof d!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");const t=R(),l=d,_=()=>y.value,h=()=>t.isHydrating?t.payload.data[e]:t.static.data[e];a.server=a.server??!0,a.default=a.default??_,a.getCachedData=a.getCachedData??h,a.lazy=a.lazy??!1,a.immediate=a.immediate??!0,a.deep=a.deep??y.deep,a.dedupe=a.dedupe??"cancel";const p=()=>a.getCachedData(e,t)!=null;if(!t._asyncData[e]||!a.immediate){(V=t.payload._errors)[e]??(V[e]=y.errorValue);const i=a.deep?C:z;t._asyncData[e]={data:i(a.getCachedData(e,t)??a.default()),pending:C(!p()),error:G(t.payload._errors,e),status:C("idle"),_default:a.default}}const n={...t._asyncData[e]};delete n._default,n.refresh=n.execute=(i={})=>{if(t._asyncDataPromises[e]){if(Y(i.dedupe??a.dedupe))return t._asyncDataPromises[e];t._asyncDataPromises[e].cancelled=!0}if((i._initial||t.isHydrating&&i._initial!==!1)&&p())return Promise.resolve(a.getCachedData(e,t));n.pending.value=!0,n.status.value="pending";const f=new Promise((c,r)=>{try{c(l(t))}catch(P){r(P)}}).then(async c=>{if(f.cancelled)return t._asyncDataPromises[e];let r=c;a.transform&&(r=await a.transform(c)),a.pick&&(r=ee(r,a.pick)),t.payload.data[e]=r,n.data.value=r,n.error.value=y.errorValue,n.status.value="success"}).catch(c=>{if(f.cancelled)return t._asyncDataPromises[e];n.error.value=F(c),n.data.value=u(a.default()),n.status.value="error"}).finally(()=>{f.cancelled||(n.pending.value=!1,delete t._asyncDataPromises[e])});return t._asyncDataPromises[e]=f,t._asyncDataPromises[e]},n.clear=()=>A(t,e);const v=()=>n.refresh({_initial:!0}),b=a.server!==!1&&t.payload.serverRendered;{const i=U();if(i&&!i._nuxtOnBeforeMountCbs){i._nuxtOnBeforeMountCbs=[];const r=i._nuxtOnBeforeMountCbs;H(()=>{r.forEach(P=>{P()}),r.splice(0,r.length)}),I(()=>r.splice(0,r.length))}b&&t.isHydrating&&(n.error.value||p())?(n.pending.value=!1,n.status.value=n.error.value?"error":"success"):i&&(t.payload.serverRendered&&t.isHydrating||a.lazy)&&a.immediate?i._nuxtOnBeforeMountCbs.push(v):a.immediate&&v();const f=W();if(a.watch){const r=j(a.watch,()=>n.refresh());f&&N(r)}const c=t.hook("app:data:refresh",async r=>{(!r||r.includes(e))&&await n.refresh()});f&&N(c)}const T=Promise.resolve(t._asyncDataPromises[e]).then(()=>n);return Object.assign(T,n),T}function A(s,o){o in s.payload.data&&(s.payload.data[o]=void 0),o in s.payload._errors&&(s.payload._errors[o]=y.errorValue),s._asyncData[o]&&(s._asyncData[o].data.value=void 0,s._asyncData[o].error.value=y.errorValue,s._asyncData[o].pending.value=!1,s._asyncData[o].status.value="idle"),o in s._asyncDataPromises&&(s._asyncDataPromises[o]&&(s._asyncDataPromises[o].cancelled=!0),s._asyncDataPromises[o]=void 0)}function ee(s,o){const e={};for(const d of o)e[d]=s[d];return e}const ae=S("span",{class:"w-full"},"透過 Google 登入",-1),te={key:1},se=S("span",{class:"w-full"},"登出",-1),ie=K({__name:"index",setup(s){const o=L(),e=$(),{data:d,error:a}=Z("get_data",async()=>{const{data:l,error:_}=await o.from("reservation_list").select();return _?null:l}),t={async loginWithGoogle(){const l=C("");window.location.host==="localhost:3000"?l.value="localhost:3000":l.value="bearyep.github.io/STP_Reservation/",await o.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.protocol+"//"+l.value+"/auth/callback"}})}};return(l,_)=>{const h=M,p=k,n=q("Icon");return m(),g("div",null,[(m(!0),g(J,null,Q(u(d),(v,b)=>(m(),g("div",{key:b},[S("span",null,O(v.name),1)]))),128)),x(" 測試 "),D(p,{to:"a"},{default:w(()=>[D(h,null,{default:w(()=>[x(" 到下一頁 ")]),_:1})]),_:1}),u(e)?B("",!0):(m(),E(h,{key:0,class:"w-full flex",variant:"outline",onClick:t.loginWithGoogle},{default:w(()=>[D(n,{name:"devicon:google"}),ae]),_:1},8,["onClick"])),u(e)?(m(),g("div",te,O(u(e).id)+" , email: "+O(u(e).email),1)):B("",!0),u(e)?(m(),E(h,{key:2,class:"w-full flex",variant:"outline",onClick:_[0]||(_[0]=v=>("navigateTo"in l?l.navigateTo:u(X))("/logout"))},{default:w(()=>[D(n,{name:"devicon:google"}),se]),_:1})):B("",!0)])}}});export{ie as default};
