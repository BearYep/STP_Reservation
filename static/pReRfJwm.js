import{_ as U,a as W,u as S,b as J}from"./DeOJMQ27.js";import{f as k,x as M,o as u,j as y,w as t,k as C,l as A,m as G,q as e,z as X,N as V,K as Q,c as D,s as q,v as N,y as I,B as E,A as K,C as Y,D as Z,b as a,E as ee,F as se,X as ae,G as re,a as n,g as L,d as h,n as te,t as w,H as O,I as oe,J as H,r as le,h as ne}from"./DCHnGnt-.js";import ue from"./DKxxESw0.js";import"./xA7j3kN9.js";import"./Do48s20l.js";import"./DlAUqK2U.js";const de=k({__name:"Dialog",props:{open:{type:Boolean},defaultOpen:{type:Boolean},modal:{type:Boolean}},emits:["update:open"],setup(f,{emit:s}){const b=M(f,s);return(r,l)=>(u(),y(e(X),A(G(e(b))),{default:t(()=>[C(r.$slots,"default")]),_:3},16))}}),_e=k({__name:"DialogClose",props:{asChild:{type:Boolean},as:{}},setup(f){const s=f;return(d,o)=>(u(),y(e(V),A(G(s)),{default:t(()=>[C(d.$slots,"default")]),_:3},16))}}),ie=k({__name:"DialogTrigger",props:{asChild:{type:Boolean},as:{}},setup(f){const s=f;return(d,o)=>(u(),y(e(Q),A(G(s)),{default:t(()=>[C(d.$slots,"default")]),_:3},16))}}),pe=k({__name:"DialogHeader",props:{class:{}},setup(f){const s=f;return(d,o)=>(u(),D("div",{class:q(e(N)("flex flex-col gap-y-1.5 text-center sm:text-left",s.class))},[C(d.$slots,"default")],2))}}),fe=k({__name:"DialogTitle",props:{asChild:{type:Boolean},as:{},class:{}},setup(f){const s=f,d=I(()=>{const{class:b,...r}=s;return r}),o=E(d);return(b,r)=>(u(),y(e(Y),K(e(o),{class:e(N)("text-lg font-semibold leading-none tracking-tight",s.class)}),{default:t(()=>[C(b.$slots,"default")]),_:3},16,["class"]))}}),ce=k({__name:"DialogDescription",props:{asChild:{type:Boolean},as:{},class:{}},setup(f){const s=f,d=I(()=>{const{class:b,...r}=s;return r}),o=E(d);return(b,r)=>(u(),y(e(Z),K(e(o),{class:e(N)("text-sm text-muted-foreground",s.class)}),{default:t(()=>[C(b.$slots,"default")]),_:3},16,["class"]))}}),he=n("span",{class:"sr-only"},"Close",-1),me=k({__name:"DialogContent",props:{forceMount:{type:Boolean},trapFocus:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(f,{emit:s}){const d=f,o=s,b=I(()=>{const{class:l,...m}=d;return m}),r=M(b,o);return(l,m)=>(u(),y(e(re),null,{default:t(()=>[a(e(ee),{class:"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"}),a(e(se),K(e(r),{class:e(N)("fixed left-1/2 top-1/2 z-50 grid w-full max-w-lg -translate-x-1/2 -translate-y-1/2 gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",d.class)}),{default:t(()=>[C(l.$slots,"default"),a(e(V),{class:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground"},{default:t(()=>[a(e(ae),{class:"w-4 h-4"}),he]),_:1})]),_:3},16,["class"])]),_:3}))}}),ye=k({__name:"DialogFooter",props:{class:{}},setup(f){const s=f;return(d,o)=>(u(),D("div",{class:q(e(N)("flex flex-col-reverse sm:flex-row sm:justify-end sm:gap-x-2",s.class))},[C(d.$slots,"default")],2))}}),ge={class:"grid gap-4 py-4"},ve={class:"grid gap-4 py-4"},we=n("span",{class:"w-full"},"透過 Google 登入",-1),be={class:"flex flex-col text-xs"},xe={class:"flex flex-col text-xs"},ke=k({__name:"reservation_button",props:{data:{},user:{},your_seat:{},data_refresh:{type:Function},personal_refresh:{type:Function}},setup(f){const s=L(),d=f;async function o(r,l,m){await s.from("seat").upsert({group:r,number:l,user_id:m,status:"taken"}),oe({title:"已送出預約資料!",description:H("pre",{class:"mt-2 w-[340px] rounded-md bg-slate-950 p-4"},H("code",{class:"text-white"},JSON.stringify({group:r,number:l,id:m},null,2)))}),await d.data_refresh(),await d.personal_refresh()}const b={async loginWithGoogle(){const r=le("localhost:3000");window.location.host==="localhost:3000"?r.value="localhost:3000":r.value="bearyep.github.io/STP_Reservation/",console.log(r),await s.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.protocol+"//"+window.location.host+"/auth/callback"}})}};return(r,l)=>{var R;const m=U,c=ie,i=fe,P=pe,p=me,x=ce,g=W,$=_e,_=ye,F=ue,T=de;return u(),D("div",null,[r.data.status==="available"?(u(),y(T,{key:0},{default:t(()=>{var B;return[a(c,null,{default:t(()=>[a(m,{class:"rounded-full h-[40px] w-[75px]",variant:"outline"},{default:t(()=>[h(" 可預約 ")]),_:1})]),_:1}),((B=r.user)==null?void 0:B.first_time)===!0?(u(),y(p,{key:0,class:"sm:max-w-[425px]"},{default:t(()=>[a(P,null,{default:t(()=>[a(i,null,{default:t(()=>[h("請先填寫資料。")]),_:1})]),_:1}),a(m,{onClick:l[0]||(l[0]=v=>("navigateTo"in r?r.navigateTo:e(te))("/profile_edit"))},{default:t(()=>[h(" 個人資料編輯 ")]),_:1})]),_:1})):r.your_seat&&r.your_seat[0]?(u(),y(p,{key:1,class:"sm:max-w-[425px]"},{default:t(()=>[a(P,null,{default:t(()=>[a(i,null,{default:t(()=>[h("您已預約位置")]),_:1}),a(x,null,{default:t(()=>[h(" 以下為您的預約資料。 ")]),_:1})]),_:1}),n("div",ge,[a(g,null,{default:t(()=>[h(" 位置：第 "+w(r.your_seat[0].group)+" 組 - "+w(r.your_seat[0].number),1)]),_:1}),a(g,null,{default:t(()=>[h(" 綽號："+w(r.your_seat[0].app_user.nick_name),1)]),_:1}),a(g,null,{default:t(()=>[h(" MBTI："+w(r.your_seat[0].app_user.mbti),1)]),_:1})]),a(_,null,{default:t(()=>[a($,{"as-child":""},{default:t(()=>[a(m,{variant:"outline"},{default:t(()=>[h(" 關閉 ")]),_:1})]),_:1})]),_:1})]),_:1})):r.user?(u(),y(p,{key:2,class:"sm:max-w-[425px]"},{default:t(()=>[a(P,null,{default:t(()=>[a(i,null,{default:t(()=>[h("確認要預約這個座位嗎?")]),_:1}),a(x,null,{default:t(()=>[h(" 請確認以下的資料，送出後無法更改。 ")]),_:1})]),_:1}),n("div",ve,[a(g,null,{default:t(()=>[h(" 位置：第 "+w(r.data.group)+" 組 - "+w(r.data.number),1)]),_:1}),a(g,null,{default:t(()=>{var v;return[h(" 綽號："+w((v=r.user)==null?void 0:v.nick_name),1)]}),_:1}),a(g,null,{default:t(()=>{var v;return[h(" MBTI："+w((v=r.user)==null?void 0:v.mbti),1)]}),_:1})]),a(_,null,{default:t(()=>[a($,{"as-child":""},{default:t(()=>[a(m,{onClick:l[1]||(l[1]=v=>{o(r.data.group,r.data.number,r.user.id)}),class:"bg-green-500 text-white px-4 py-1 rounded"},{default:t(()=>[h(" 確認 ")]),_:1})]),_:1}),a($,{"as-child":""},{default:t(()=>[a(m,{variant:"outline"},{default:t(()=>[h(" 關閉 ")]),_:1})]),_:1})]),_:1})]),_:1})):(u(),y(p,{key:3,class:"sm:max-w-[425px]"},{default:t(()=>[a(P,null,{default:t(()=>[a(i,null,{default:t(()=>[h("請先登入。")]),_:1})]),_:1}),a(m,{variant:"outline",onClick:b.loginWithGoogle},{default:t(()=>[a(F,{name:"devicon:google"}),we]),_:1},8,["onClick"])]),_:1}))]}),_:1})):O("",!0),r.data.user_id===((R=r.user)==null?void 0:R.id)?(u(),y(m,{key:1,class:"bg-green-500 text-white px-4 py-1 rounded-full h-[40px] w-[75px]",disabled:""},{default:t(()=>{var B,v,z,j;return[n("div",be,[n("div",null,w((B=r.data.app_user)!=null&&B.nick_name?(v=r.data.app_user)==null?void 0:v.nick_name:"無"),1),n("div",null,w((z=r.data.app_user)!=null&&z.mbti?(j=r.data.app_user)==null?void 0:j.mbti:"無"),1)])]}),_:1})):r.data.status==="taken"?(u(),y(m,{key:2,variant:"destructive",class:"rounded-full h-[40px] w-[75px]",disabled:""},{default:t(()=>{var B,v,z,j;return[n("div",xe,[n("div",null,w((B=r.data.app_user)!=null&&B.nick_name?(v=r.data.app_user)==null?void 0:v.nick_name:"無"),1),n("div",null,w((z=r.data.app_user)!=null&&z.mbti?(j=r.data.app_user)==null?void 0:j.mbti:"無"),1)])]}),_:1})):r.data.status==="lock"?(u(),y(m,{key:3,variant:"secondary",class:"rounded-full h-[40px] w-[75px] bg-white",disabled:""})):O("",!0)])}}}),$e={class:"flex flex-col gap-3 w-[300px]"},De={class:"flex flex-row justify-center gap-3"},Be={class:"flex flex-col gap-3"},Ce={key:0,class:"w-[150px] border-2 flex place-content-center place-items-center"},Te={key:1,class:"w-[150px] flex place-content-center place-items-center"},Pe={class:"flex flex-col gap-3"},Fe={class:"flex flex-row justify-center gap-3"},ze=k({__name:"group_table",props:{user:{},list:{},your_seat:{},data_refresh:{type:Function},personal_refresh:{type:Function}},setup(f){return(s,d)=>{const o=ke;return u(),D("div",$e,[n("div",De,[n("div",Be,[a(o,{user:s.user,data:s.list[0],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"]),a(o,{user:s.user,data:s.list[1],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"])]),s.list[0].status!=="lock"?(u(),D("div",Ce,"第"+w(s.list[0].group)+"組",1)):(u(),D("div",Te)),n("div",Pe,[a(o,{user:s.user,data:s.list[2],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"]),a(o,{user:s.user,data:s.list[3],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"])])]),n("div",Fe,[a(o,{user:s.user,data:s.list[4],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"]),a(o,{user:s.user,data:s.list[5],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"]),a(o,{user:s.user,data:s.list[6],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"])])])}}}),je={class:"flex flex-col gap-7"},Ne={class:"container mx-auto px-4 border-2 flex flex-col gap-2"},Oe=n("div",null,[n("div",{class:"font-bold text-2xl"},"STP暑期黑馬營劃位"),n("div",{class:"text-gray-500"},"說明文字..."),n("img",{src:"https://images.plurk.com/5nmKlgKPdXuUiCcLjdLHvR.jpg",class:"w-[1364px]"})],-1),Se=n("div",{class:"border-2 h-[5px]"},null,-1),Ae={class:"container mx-auto overflow-x-auto"},Ge={key:0,class:"flex flex-col gap-10"},Ie=n("div",{class:"flex flex-row gap-[50px] w-[1300px] justify-center"},[n("div",{class:"w-[350px] h-[50px] border-2 flex place-content-center place-items-center"},"投影幕"),n("div",{class:"w-[200px] h-[50px] border-2 flex place-content-center place-items-center"},"講台"),n("div",{class:"w-[350px] h-[50px] border-2 flex place-content-center place-items-center"},"投影幕")],-1),Ke={class:"flex flex-row gap-10"},Re={class:"flex flex-row gap-10"},He={class:"flex flex-row gap-10"},Me={key:0,class:"flex flex-row gap-10"},Je=k({__name:"index",setup(f){const s=L(),d=ne(),{data:o,error:b,refresh:r}=S("get_user",async()=>{const{data:x,error:g}=await s.from("app_user").select("*").eq("id",d.value.id);return g?null:x[0]}),{data:l,error:m,refresh:c}=S("get_data",async()=>{const{data:x,error:g}=await s.from("seat").select("*, app_user(*)").order("number",{ascending:!0});if(g)return null;let $=[];const _=[];for(let F=1;F<=16;F++){for(let T=0;T<x.length;T++)x[T].group===F&&$.push(x[T]);_.push($),$=[]}return _}),{data:i,error:P,refresh:p}=S("get_personal_data",async()=>{const{data:x,error:g}=await s.from("seat").select("*, app_user(*)").eq("user_id",d.value.id);return g?null:x});return(x,g)=>{const $=J,_=ze;return u(),D("div",je,[a($,{class:"px-2 md:px-4 sticky top-4 z-20"}),n("div",Ne,[Oe,Se,n("div",Ae,[e(l)?(u(),D("div",Ge,[Ie,n("div",Ke,[a(_,{user:e(o),list:e(l)[0],data_refresh:e(c),personal_refresh:e(p),your_seat:e(i)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(o),list:e(l)[1],data_refresh:e(c),personal_refresh:e(p),your_seat:e(i)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(o),list:e(l)[2],data_refresh:e(c),personal_refresh:e(p),your_seat:e(i)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(o),list:e(l)[3],data_refresh:e(c),personal_refresh:e(p),your_seat:e(i)},null,8,["user","list","data_refresh","personal_refresh","your_seat"])]),n("div",Re,[a(_,{user:e(o),list:e(l)[4],data_refresh:e(c),personal_refresh:e(p),your_seat:e(i)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(o),list:e(l)[5],data_refresh:e(c),personal_refresh:e(p),your_seat:e(i)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(o),list:e(l)[6],data_refresh:e(c),personal_refresh:e(p),your_seat:e(i)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(o),list:e(l)[7],data_refresh:e(c),personal_refresh:e(p),your_seat:e(i)},null,8,["user","list","data_refresh","personal_refresh","your_seat"])]),n("div",He,[a(_,{user:e(o),list:e(l)[10],data_refresh:e(c),personal_refresh:e(p),your_seat:e(i)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(o),list:e(l)[8],data_refresh:e(c),personal_refresh:e(p),your_seat:e(i)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(o),list:e(l)[9],data_refresh:e(c),personal_refresh:e(p),your_seat:e(i)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(o),list:e(l)[11],data_refresh:e(c),personal_refresh:e(p),your_seat:e(i)},null,8,["user","list","data_refresh","personal_refresh","your_seat"])]),e(l)[12][0].status!=="lock"?(u(),D("div",Me,[a(_,{user:e(o),list:e(l)[14],data_refresh:e(c),personal_refresh:e(p),your_seat:e(i)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(o),list:e(l)[12],data_refresh:e(c),personal_refresh:e(p),your_seat:e(i)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(o),list:e(l)[13],data_refresh:e(c),personal_refresh:e(p),your_seat:e(i)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(o),list:e(l)[15],data_refresh:e(c),personal_refresh:e(p),your_seat:e(i)},null,8,["user","list","data_refresh","personal_refresh","your_seat"])])):O("",!0)])):O("",!0)])])])}}});export{Je as default};
