import{u as L,_ as A,a as I}from"./8-SRCtRu.js";import{f as $,o,c as i,a as M,j as g,k as y,l as x,m as h,g as J,h as K,b as t,w as e,q as H,F as j,s as z,v as B,d as s,x as q,t as v}from"./CRhVPP4T.js";import"./WPmz96ii.js";import"./Ovp3nEBI.js";import"./DlAUqK2U.js";import"./Dl-IW3CQ.js";const O={class:"relative w-full overflow-auto"},P=$({__name:"Table",props:{class:{}},setup(p){const r=p;return(u,k)=>(o(),i("div",O,[M("table",{class:y(x(h)("w-full caption-bottom text-sm",r.class))},[g(u.$slots,"default")],2)]))}}),Q=$({__name:"TableBody",props:{class:{}},setup(p){const r=p;return(u,k)=>(o(),i("tbody",{class:y(x(h)("[&_tr:last-child]:border-0",r.class))},[g(u.$slots,"default")],2))}}),W=$({__name:"TableCell",props:{class:{}},setup(p){const r=p;return(u,k)=>(o(),i("td",{class:y(x(h)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r.class))},[g(u.$slots,"default")],2))}}),X=$({__name:"TableHead",props:{class:{}},setup(p){const r=p;return(u,k)=>(o(),i("th",{class:y(x(h)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r.class))},[g(u.$slots,"default")],2))}}),Y=$({__name:"TableHeader",props:{class:{}},setup(p){const r=p;return(u,k)=>(o(),i("thead",{class:y(x(h)("[&_tr]:border-b",r.class))},[g(u.$slots,"default")],2))}}),Z=$({__name:"TableRow",props:{class:{}},setup(p){const r=p;return(u,k)=>(o(),i("tr",{class:y(x(h)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r.class))},[g(u.$slots,"default")],2))}}),ee={class:"flex flex-col gap-7"},te={key:0,class:"grid grid-cols-2 gap-3 container overflow-x-auto"},se={key:1,class:"flex flex-col gap-3 container mx-auto overflow-x-auto"},_e=$({__name:"backside",setup(p){const r=J(),u=K(),{data:k,error:ae,refresh:le}=L("get_admin",async()=>{const{data:n,error:a}=await r.from("admin").select("*").eq("id",u.value.id);return a?null:n[0]}),{data:D,error:re,refresh:N}=L("get_data",async()=>{const{data:n,error:a}=await r.from("seat").select("*, app_user(*)").order("number",{ascending:!0});if(a)return null;let b=[];const _=[];for(let c=1;c<=16;c++){for(let w=0;w<n.length;w++)n[w].group===c&&b.push(n[w]);_.push(b),b=[]}return _}),C=async n=>{console.log(n);const{data:a,error:b}=await r.from("seat").update({status:"available"}).eq("group",n);b?B({title:"未知的錯誤！開啟組別尚未完成，請聯繫工作人員！",variant:"destructive"}):(B({title:"已開啟第"+n+"組的座位!"}),await N())},T=async n=>{console.log(n);const{data:a,error:b}=await r.from("seat").update({status:"lock"}).eq("group",n);b?B({title:"未知的錯誤！鎖定組別尚未完成，請聯繫工作人員！",variant:"destructive"}):(B({title:"已鎖定第"+n+"組的座位!"}),await N())};return(n,a)=>{const b=I,_=A,c=X,w=Z,E=Y,m=W,F=Q,G=P;return o(),i("div",ee,[t(b,{class:"px-2 md:px-4 sticky top-4 z-20"}),x(k)?(o(),i("div",te,[t(_,{onClick:a[0]||(a[0]=d=>C(11)),variant:"outline"},{default:e(()=>[s("開啟第十一組")]),_:1}),t(_,{onClick:a[1]||(a[1]=d=>T(11)),variant:"destructive"},{default:e(()=>[s("關閉第十一組")]),_:1}),t(_,{onClick:a[2]||(a[2]=d=>C(12)),variant:"outline"},{default:e(()=>[s("開啟第十二組")]),_:1}),t(_,{onClick:a[3]||(a[3]=d=>T(12)),variant:"destructive"},{default:e(()=>[s("關閉第十二組")]),_:1}),t(_,{onClick:a[4]||(a[4]=d=>C(13)),variant:"outline"},{default:e(()=>[s("開啟第十三組")]),_:1}),t(_,{onClick:a[5]||(a[5]=d=>T(13)),variant:"destructive"},{default:e(()=>[s("關閉第十三組")]),_:1}),t(_,{onClick:a[6]||(a[6]=d=>C(14)),variant:"outline"},{default:e(()=>[s("開啟第十四組")]),_:1}),t(_,{onClick:a[7]||(a[7]=d=>T(14)),variant:"destructive"},{default:e(()=>[s("關閉第十四組")]),_:1})])):H("",!0),x(k)?(o(),i("div",se,[(o(!0),i(j,null,z(x(D),(d,R)=>(o(),i("div",{key:R},[d[0].group!==15&&d[0].group!==16?(o(),q(G,{key:0,class:"w-[1300px]"},{default:e(()=>[t(E,null,{default:e(()=>[t(w,null,{default:e(()=>[t(c,{class:"w-[50px]"},{default:e(()=>[s("組別")]),_:1}),t(c,{class:"w-[80px]"},{default:e(()=>[s("座位號碼")]),_:1}),t(c,{class:"w-[80px]"},{default:e(()=>[s("座位狀態")]),_:1}),t(c,{class:"w-[80px]"},{default:e(()=>[s("本名")]),_:1}),t(c,{class:"w-[250px]"},{default:e(()=>[s("Email")]),_:1}),t(c,{class:"w-[100px]"},{default:e(()=>[s("手機")]),_:1}),t(c,{class:"w-[200px]"},{default:e(()=>[s("學校/科系")]),_:1}),t(c,{class:"w-[100px]"},{default:e(()=>[s("綽號")]),_:1}),t(c,{class:"w-[80px]"},{default:e(()=>[s("MBTI")]),_:1})]),_:1})]),_:1}),t(F,null,{default:e(()=>[(o(!0),i(j,null,z(d,(f,U)=>(o(),q(w,{key:U},{default:e(()=>{var S;return[t(m,{class:""},{default:e(()=>[s(v(f.group),1)]),_:2},1024),t(m,null,{default:e(()=>[s(v(f.number),1)]),_:2},1024),t(m,null,{default:e(()=>[s(v(f.status),1)]),_:2},1024),t(m,null,{default:e(()=>{var l;return[s(v((l=f.app_user)==null?void 0:l.name),1)]}),_:2},1024),t(m,{class:""},{default:e(()=>{var l;return[s(v((l=f.app_user)==null?void 0:l.email),1)]}),_:2},1024),t(m,null,{default:e(()=>{var l;return[s(v((l=f.app_user)==null?void 0:l.phone),1)]}),_:2},1024),(S=f.app_user)!=null&&S.school?(o(),q(m,{key:0},{default:e(()=>{var l,V;return[s(v((l=f.app_user)==null?void 0:l.school)+" / "+v((V=f.app_user)==null?void 0:V.department),1)]}),_:2},1024)):(o(),q(m,{key:1})),t(m,null,{default:e(()=>{var l;return[s(v((l=f.app_user)==null?void 0:l.nick_name),1)]}),_:2},1024),t(m,null,{default:e(()=>{var l;return[s(v((l=f.app_user)==null?void 0:l.mbti),1)]}),_:2},1024)]}),_:2},1024))),128))]),_:2},1024)]),_:2},1024)):H("",!0)]))),128))])):H("",!0)])}}});export{_e as default};
