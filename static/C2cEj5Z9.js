import{_ as q,u as S,a as W}from"./DQpOCgSy.js";import R from"./CVLzIqc3.js";import{f as $,y as V,o as u,x as y,w as r,j as T,z as I,A as M,l as e,B as X,N as G,K as J,c as g,k as H,m as K,C as N,D as L,E as A,G as Q,H as Y,b as a,I as Z,J as ee,X as se,L as ae,a as n,g as U,d as c,n as te,t as w,q as j,v as re,r as oe,h as le,i as ne,M as ue}from"./Cec1R0xs.js";import{_ as de}from"./BaBGx6ob.js";import"./CEI7pgpU.js";import"./BOZ2vmtF.js";import"./DlAUqK2U.js";const ie=$({__name:"Dialog",props:{open:{type:Boolean},defaultOpen:{type:Boolean},modal:{type:Boolean}},emits:["update:open"],setup(f,{emit:s}){const b=V(f,s);return(t,l)=>(u(),y(e(X),I(M(e(b))),{default:r(()=>[T(t.$slots,"default")]),_:3},16))}}),_e=$({__name:"DialogClose",props:{asChild:{type:Boolean},as:{}},setup(f){const s=f;return(d,o)=>(u(),y(e(G),I(M(s)),{default:r(()=>[T(d.$slots,"default")]),_:3},16))}}),pe=$({__name:"DialogTrigger",props:{asChild:{type:Boolean},as:{}},setup(f){const s=f;return(d,o)=>(u(),y(e(J),I(M(s)),{default:r(()=>[T(d.$slots,"default")]),_:3},16))}}),ce=$({__name:"DialogHeader",props:{class:{}},setup(f){const s=f;return(d,o)=>(u(),g("div",{class:H(e(K)("flex flex-col gap-y-1.5 text-center sm:text-left",s.class))},[T(d.$slots,"default")],2))}}),fe=$({__name:"DialogTitle",props:{asChild:{type:Boolean},as:{},class:{}},setup(f){const s=f,d=N(()=>{const{class:b,...t}=s;return t}),o=L(d);return(b,t)=>(u(),y(e(Q),A(e(o),{class:e(K)("text-lg font-semibold leading-none tracking-tight",s.class)}),{default:r(()=>[T(b.$slots,"default")]),_:3},16,["class"]))}}),he=$({__name:"DialogDescription",props:{asChild:{type:Boolean},as:{},class:{}},setup(f){const s=f,d=N(()=>{const{class:b,...t}=s;return t}),o=L(d);return(b,t)=>(u(),y(e(Y),A(e(o),{class:e(K)("text-sm text-muted-foreground",s.class)}),{default:r(()=>[T(b.$slots,"default")]),_:3},16,["class"]))}}),me=n("span",{class:"sr-only"},"Close",-1),ye=$({__name:"DialogContent",props:{forceMount:{type:Boolean},trapFocus:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(f,{emit:s}){const d=f,o=s,b=N(()=>{const{class:l,...m}=d;return m}),t=V(b,o);return(l,m)=>(u(),y(e(ae),null,{default:r(()=>[a(e(Z),{class:"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"}),a(e(ee),A(e(t),{class:e(K)("fixed left-1/2 top-1/2 z-50 grid w-full max-w-lg -translate-x-1/2 -translate-y-1/2 gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",d.class)}),{default:r(()=>[T(l.$slots,"default"),a(e(G),{class:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground"},{default:r(()=>[a(e(se),{class:"w-4 h-4"}),me]),_:1})]),_:3},16,["class"])]),_:3}))}}),ge=$({__name:"DialogFooter",props:{class:{}},setup(f){const s=f;return(d,o)=>(u(),g("div",{class:H(e(K)("flex flex-col-reverse sm:flex-row sm:justify-end sm:gap-x-2",s.class))},[T(d.$slots,"default")],2))}}),ve={class:"grid gap-4 py-4"},xe={class:"grid gap-4 py-4"},we=n("span",{class:"w-full"},"透過 Google 登入",-1),be={class:"flex flex-col text-xs"},ke={class:"flex flex-col text-xs"},$e=$({__name:"reservation_button",props:{data:{},user:{},your_seat:{},data_refresh:{type:Function},personal_refresh:{type:Function}},setup(f){const s=U(),d=f;async function o(t,l,m){await s.from("seat").upsert({group:t,number:l,user_id:m,status:"taken"}),re({title:"已送出預約資料!"}),await d.data_refresh(),await d.personal_refresh()}const b={async loginWithGoogle(){const t=oe("localhost:3000");window.location.host==="localhost:3000"?t.value="localhost:3000":t.value="bearyep.github.io/STP_Reservation/",console.log(t),await s.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.protocol+"//bearyep.github.io/STP_Reservation//auth/callback"}})}};return(t,l)=>{var O;const m=q,h=pe,p=fe,F=ce,i=ye,k=he,v=de,D=_e,B=ge,_=R,P=ie;return u(),g("div",null,[t.data.status==="available"?(u(),y(P,{key:0},{default:r(()=>{var C;return[a(h,null,{default:r(()=>[a(m,{class:"rounded-full h-[40px] w-[75px]",variant:"outline"},{default:r(()=>[c(" 可預約 ")]),_:1})]),_:1}),((C=t.user)==null?void 0:C.first_time)===!0?(u(),y(i,{key:0,class:"sm:max-w-[425px]"},{default:r(()=>[a(F,null,{default:r(()=>[a(p,null,{default:r(()=>[c("請先填寫資料。")]),_:1})]),_:1}),a(m,{onClick:l[0]||(l[0]=x=>("navigateTo"in t?t.navigateTo:e(te))("/profile_edit"))},{default:r(()=>[c(" 個人資料編輯 ")]),_:1})]),_:1})):t.your_seat&&t.your_seat[0]?(u(),y(i,{key:1,class:"sm:max-w-[425px]"},{default:r(()=>[a(F,null,{default:r(()=>[a(p,null,{default:r(()=>[c("您已預約位置")]),_:1}),a(k,null,{default:r(()=>[c(" 以下為您的預約資料。 ")]),_:1})]),_:1}),n("div",ve,[a(v,null,{default:r(()=>[c(" 位置：第 "+w(t.your_seat[0].group)+" 組 - "+w(t.your_seat[0].number),1)]),_:1}),a(v,null,{default:r(()=>[c(" 綽號："+w(t.your_seat[0].app_user.nick_name),1)]),_:1}),a(v,null,{default:r(()=>[c(" MBTI："+w(t.your_seat[0].app_user.mbti),1)]),_:1})]),a(B,null,{default:r(()=>[a(D,{"as-child":""},{default:r(()=>[a(m,{variant:"outline"},{default:r(()=>[c(" 關閉 ")]),_:1})]),_:1})]),_:1})]),_:1})):t.user?(u(),y(i,{key:2,class:"sm:max-w-[425px]"},{default:r(()=>[a(F,null,{default:r(()=>[a(p,null,{default:r(()=>[c("確認要預約這個座位嗎?")]),_:1}),a(k,{class:"text-red-500 font-bold"},{default:r(()=>[c(" 請確認以下的資料，送出後無法更改。 ")]),_:1})]),_:1}),n("div",xe,[a(v,null,{default:r(()=>[c(" 位置：第 "+w(t.data.group)+" 組 - "+w(t.data.number),1)]),_:1}),a(v,null,{default:r(()=>{var x;return[c(" 綽號："+w((x=t.user)==null?void 0:x.nick_name),1)]}),_:1}),a(v,null,{default:r(()=>{var x;return[c(" MBTI："+w((x=t.user)==null?void 0:x.mbti),1)]}),_:1})]),a(B,null,{default:r(()=>[a(D,{"as-child":""},{default:r(()=>[a(m,{onClick:l[1]||(l[1]=x=>{o(t.data.group,t.data.number,t.user.id)}),class:"bg-green-500 text-white px-4 py-1 rounded"},{default:r(()=>[c(" 確認 ")]),_:1})]),_:1}),a(D,{"as-child":""},{default:r(()=>[a(m,{variant:"outline"},{default:r(()=>[c(" 關閉 ")]),_:1})]),_:1})]),_:1})]),_:1})):(u(),y(i,{key:3,class:"sm:max-w-[425px]"},{default:r(()=>[a(F,null,{default:r(()=>[a(p,null,{default:r(()=>[c("請先登入。")]),_:1})]),_:1}),a(m,{variant:"outline",onClick:b.loginWithGoogle},{default:r(()=>[a(_,{name:"devicon:google"}),we]),_:1},8,["onClick"])]),_:1}))]}),_:1})):j("",!0),t.data.user_id===((O=t.user)==null?void 0:O.id)?(u(),y(m,{key:1,class:"bg-green-600 text-white px-4 py-1 rounded-full h-[40px] w-[75px]",disabled:""},{default:r(()=>{var C,x,z,E;return[n("div",be,[n("div",null,w((C=t.data.app_user)!=null&&C.nick_name?(x=t.data.app_user)==null?void 0:x.nick_name:"無"),1),n("div",null,w((z=t.data.app_user)!=null&&z.mbti?(E=t.data.app_user)==null?void 0:E.mbti:"無"),1)])]}),_:1})):t.data.status==="taken"?(u(),y(m,{key:2,class:"bg-sky-800 rounded-full h-[40px] w-[75px]",disabled:""},{default:r(()=>{var C,x,z,E;return[n("div",ke,[n("div",null,w((C=t.data.app_user)!=null&&C.nick_name?(x=t.data.app_user)==null?void 0:x.nick_name:"無"),1),n("div",null,w((z=t.data.app_user)!=null&&z.mbti?(E=t.data.app_user)==null?void 0:E.mbti:"無"),1)])]}),_:1})):t.data.status==="lock"?(u(),y(m,{key:3,variant:"secondary",class:"rounded-full h-[40px] w-[75px] bg-white",disabled:""})):j("",!0)])}}}),De={class:"flex flex-col gap-3 w-[300px]"},Be={class:"flex flex-row justify-center gap-3"},Ce={class:"flex flex-col gap-3"},Te={key:0,class:"w-[150px] border-2 flex place-content-center place-items-center"},Pe={key:1,class:"w-[150px] flex place-content-center place-items-center"},je={class:"flex flex-col gap-3"},Fe={class:"flex flex-row justify-center gap-3"},ze=$({__name:"group_table",props:{user:{},list:{},your_seat:{},data_refresh:{type:Function},personal_refresh:{type:Function}},setup(f){return(s,d)=>{const o=$e;return u(),g("div",De,[n("div",Be,[n("div",Ce,[a(o,{user:s.user,data:s.list[0],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"]),a(o,{user:s.user,data:s.list[1],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"])]),s.list[0].status!=="lock"?(u(),g("div",Te,"第"+w(s.list[0].group)+"組",1)):(u(),g("div",Pe)),n("div",je,[a(o,{user:s.user,data:s.list[2],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"]),a(o,{user:s.user,data:s.list[3],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"])])]),n("div",Fe,[a(o,{user:s.user,data:s.list[4],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"]),a(o,{user:s.user,data:s.list[5],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"]),a(o,{user:s.user,data:s.list[6],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"])])])}}}),Ee={class:"flex flex-col gap-7"},Ke={class:"container mx-auto px-4 flex flex-col gap-2"},Se=ue('<div class="font-bold text-2xl">STP暑期黑馬營劃位</div><div class="flex flex-col gap-3"><div class="text-gray-500">此為黑馬營工作坊當日座位表，大家可以選擇自己喜歡的座位哦！</div><div class="text-gray-500">⚠️登入後，首先填寫基本資料，接著便可回首頁進行劃位！</div><div class="text-gray-500">⚠️為維護同學個人隱私，劃位表中僅會出現暱稱以及填答之MBTI，請放心作答～</div></div>',2),Ie={key:0,class:"flex flex-col gap-2"},Me={key:0,src:"https://images.plurk.com/5nmKlgKPdXuUiCcLjdLHvR.jpg",class:"w-[1364px]"},Ne={key:1,src:"https://images.plurk.com/3xuQoP21F56d2etfm1nEVE.png",class:"w-[1364px]"},Ae={key:2,src:"https://images.plurk.com/1EcEKeTi9ycYfvaU0XKPEK.png",class:"w-[1364px]"},Oe=n("div",{class:"flex justify-center gap-5 text-gray-500"},"▲ 座位表",-1),Re=n("div",{class:"border-2 h-[1px]"},null,-1),Ve={class:"container mx-auto overflow-x-auto"},Ge={key:0,class:"flex flex-col gap-10"},He={class:"flex flex-row w-[1225px]"},Le={class:"flex flex-col w-[100px] h-[60px]"},Ue={class:"text-sm w-[100px] h-[20px]"},qe={class:"text-sm w-[100px] h-[20px]"},We={class:"text-sm w-[100px] h-[20px]"},Xe=n("div",{class:"flex flex-row gap-[50px] w-[1125px] justify-center"},[n("div",{class:"w-[350px] h-[60px] border-2 flex place-content-center place-items-center"},"投影幕"),n("div",{class:"w-[200px] h-[60px] border-2 flex place-content-center place-items-center"},"講台"),n("div",{class:"w-[350px] h-[60px] border-2 flex place-content-center place-items-center"},"投影幕")],-1),Je={class:"flex flex-row gap-10"},Qe={class:"flex flex-row gap-10"},Ye={class:"flex flex-row gap-10"},Ze={key:0,class:"flex flex-row gap-10"},es={key:0,class:"flex h-[50px] justify-center gap-5 text-gray-600"},us=$({__name:"index",setup(f){const s=U(),d=le(),{data:o,error:b,refresh:t}=S("get_user",async()=>{const{data:k,error:v}=await s.from("app_user").select("*").eq("id",d.value.id);return v?null:k[0]}),{data:l,error:m,refresh:h}=S("get_data",async()=>{const{data:k,error:v}=await s.from("seat").select("*, app_user(*)").order("number",{ascending:!0});if(v)return null;let D=[];const B=[];for(let _=1;_<=16;_++){for(let P=0;P<k.length;P++)k[P].group===_&&D.push(k[P]);B.push(D),D=[]}return B}),{data:p,error:F,refresh:i}=S("get_personal_data",async()=>{const{data:k,error:v}=await s.from("seat").select("*, app_user(*)").eq("user_id",d.value.id);return v?null:k});return ne(async()=>{await t(),await h(),await i()}),(k,v)=>{const D=W,B=R,_=ze;return u(),g("div",Ee,[a(D,{class:"px-2 md:px-4 sticky top-4 z-20"}),n("div",Ke,[n("div",null,[Se,e(d)?(u(),g("div",Ie,[e(l)&&e(l)[10][0].status==="lock"?(u(),g("img",Me)):e(l)&&e(l)[12][0].status==="lock"?(u(),g("img",Ne)):(u(),g("img",Ae)),Oe])):j("",!0)]),Re,n("div",Ve,[e(l)&&e(d)?(u(),g("div",Ge,[n("div",He,[n("div",Le,[n("div",Ue,[a(B,{name:"ph:circle",style:{color:"rgb(0 0 0 / 0.5)"}}),c(" ：可預約 ")]),n("div",qe,[a(B,{name:"ph:circle-duotone",style:{color:"rgb(22 163 74 / 0.5)"}}),c(" ：您的位置 ")]),n("div",We,[a(B,{name:"ph:circle-duotone",style:{color:"rgb(59 130 246 / 0.5)"}}),c(" ：已預約 ")])]),Xe]),n("div",Je,[a(_,{user:e(o),list:e(l)[0],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(o),list:e(l)[1],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(o),list:e(l)[2],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(o),list:e(l)[3],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"])]),n("div",Qe,[a(_,{user:e(o),list:e(l)[4],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(o),list:e(l)[5],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(o),list:e(l)[6],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(o),list:e(l)[7],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"])]),n("div",Ye,[a(_,{user:e(o),list:e(l)[10],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(o),list:e(l)[8],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(o),list:e(l)[9],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(o),list:e(l)[11],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"])]),e(l)[12][0].status!=="lock"?(u(),g("div",Ze,[a(_,{user:e(o),list:e(l)[14],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(o),list:e(l)[12],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(o),list:e(l)[13],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(o),list:e(l)[15],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"])])):j("",!0)])):j("",!0)]),e(d)?j("",!0):(u(),g("div",es,"請登入以查看預約列表及進行預約服務。 "))])])}}});export{us as default};
