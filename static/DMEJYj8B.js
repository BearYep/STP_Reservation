import{_ as Y,u as E,a as q}from"./DnzWabkB.js";import O from"./Bd0jvsQq.js";import{f as $,y as V,o as n,x as g,w as r,j as T,z as K,A as M,l as e,B as W,N as G,K as X,c as m,k as H,m as R,C as S,D as L,E as I,G as J,H as Q,b as a,I as Z,J as ee,X as se,L as ae,a as u,g as U,d as c,n as te,t as w,q as P,v as re,r as oe,h as le,i as ne,M as ue}from"./D0oRVHuc.js";import{_ as de}from"./CNpTtpdR.js";import"./nbomxWEH.js";import"./Bb-5Vg4g.js";import"./DlAUqK2U.js";const ie=$({__name:"Dialog",props:{open:{type:Boolean},defaultOpen:{type:Boolean},modal:{type:Boolean}},emits:["update:open"],setup(f,{emit:s}){const b=V(f,s);return(t,o)=>(n(),g(e(W),K(M(e(b))),{default:r(()=>[T(t.$slots,"default")]),_:3},16))}}),_e=$({__name:"DialogClose",props:{asChild:{type:Boolean},as:{}},setup(f){const s=f;return(d,l)=>(n(),g(e(G),K(M(s)),{default:r(()=>[T(d.$slots,"default")]),_:3},16))}}),pe=$({__name:"DialogTrigger",props:{asChild:{type:Boolean},as:{}},setup(f){const s=f;return(d,l)=>(n(),g(e(X),K(M(s)),{default:r(()=>[T(d.$slots,"default")]),_:3},16))}}),ce=$({__name:"DialogHeader",props:{class:{}},setup(f){const s=f;return(d,l)=>(n(),m("div",{class:H(e(R)("flex flex-col gap-y-1.5 text-center sm:text-left",s.class))},[T(d.$slots,"default")],2))}}),fe=$({__name:"DialogTitle",props:{asChild:{type:Boolean},as:{},class:{}},setup(f){const s=f,d=S(()=>{const{class:b,...t}=s;return t}),l=L(d);return(b,t)=>(n(),g(e(J),I(e(l),{class:e(R)("text-lg font-semibold leading-none tracking-tight",s.class)}),{default:r(()=>[T(b.$slots,"default")]),_:3},16,["class"]))}}),he=$({__name:"DialogDescription",props:{asChild:{type:Boolean},as:{},class:{}},setup(f){const s=f,d=S(()=>{const{class:b,...t}=s;return t}),l=L(d);return(b,t)=>(n(),g(e(Q),I(e(l),{class:e(R)("text-sm text-muted-foreground",s.class)}),{default:r(()=>[T(b.$slots,"default")]),_:3},16,["class"]))}}),me=u("span",{class:"sr-only"},"Close",-1),ye=$({__name:"DialogContent",props:{forceMount:{type:Boolean},trapFocus:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(f,{emit:s}){const d=f,l=s,b=S(()=>{const{class:o,...y}=d;return y}),t=V(b,l);return(o,y)=>(n(),g(e(ae),null,{default:r(()=>[a(e(Z),{class:"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"}),a(e(ee),I(e(t),{class:e(R)("fixed left-1/2 top-1/2 z-50 grid w-full max-w-lg -translate-x-1/2 -translate-y-1/2 gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",d.class)}),{default:r(()=>[T(o.$slots,"default"),a(e(G),{class:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground"},{default:r(()=>[a(e(se),{class:"w-4 h-4"}),me]),_:1})]),_:3},16,["class"])]),_:3}))}}),ge=$({__name:"DialogFooter",props:{class:{}},setup(f){const s=f;return(d,l)=>(n(),m("div",{class:H(e(R)("flex flex-col-reverse sm:flex-row sm:justify-end sm:gap-x-2",s.class))},[T(d.$slots,"default")],2))}}),ve={class:"grid gap-4 py-4"},xe={class:"grid gap-4 py-4"},we=u("span",{class:"w-full"},"透過 Google 登入",-1),be={class:"flex flex-col text-xs"},ke={class:"flex flex-col text-xs"},$e=$({__name:"reservation_button",props:{data:{},user:{},your_seat:{},data_refresh:{type:Function},personal_refresh:{type:Function}},setup(f){const s=U(),d=f;async function l(t,o,y){await s.from("seat").upsert({group:t,number:o,user_id:y,status:"taken"}),re({title:"已送出預約資料!"}),await d.data_refresh(),await d.personal_refresh()}const b={async loginWithGoogle(){const t=oe("localhost:3000");window.location.host==="localhost:3000"?t.value="localhost:3000":t.value="bearyep.github.io/STP_Reservation/",console.log(t),await s.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.protocol+"//bearyep.github.io/STP_Reservation//auth/callback"}})}};return(t,o)=>{var A;const y=Y,h=pe,p=fe,F=ce,i=ye,k=he,v=de,D=_e,B=ge,_=O,j=ie;return n(),m("div",null,[t.data.status==="available"?(n(),g(j,{key:0},{default:r(()=>{var C;return[a(h,null,{default:r(()=>[a(y,{class:"rounded-full h-[40px] w-[75px]",variant:"outline"},{default:r(()=>[c(" 可預約 ")]),_:1})]),_:1}),((C=t.user)==null?void 0:C.first_time)===!0?(n(),g(i,{key:0,class:"sm:max-w-[425px]"},{default:r(()=>[a(F,null,{default:r(()=>[a(p,null,{default:r(()=>[c("請先填寫資料。")]),_:1})]),_:1}),a(y,{onClick:o[0]||(o[0]=x=>("navigateTo"in t?t.navigateTo:e(te))("/profile_edit"))},{default:r(()=>[c(" 個人資料編輯 ")]),_:1})]),_:1})):t.your_seat&&t.your_seat[0]?(n(),g(i,{key:1,class:"sm:max-w-[425px]"},{default:r(()=>[a(F,null,{default:r(()=>[a(p,null,{default:r(()=>[c("您已預約位置")]),_:1}),a(k,null,{default:r(()=>[c(" 以下為您的預約資料。 ")]),_:1})]),_:1}),u("div",ve,[a(v,null,{default:r(()=>[c(" 位置：第 "+w(t.your_seat[0].group)+" 組 - "+w(t.your_seat[0].number),1)]),_:1}),a(v,null,{default:r(()=>[c(" 綽號："+w(t.your_seat[0].app_user.nick_name),1)]),_:1}),a(v,null,{default:r(()=>[c(" MBTI："+w(t.your_seat[0].app_user.mbti),1)]),_:1})]),a(B,null,{default:r(()=>[a(D,{"as-child":""},{default:r(()=>[a(y,{variant:"outline"},{default:r(()=>[c(" 關閉 ")]),_:1})]),_:1})]),_:1})]),_:1})):t.user?(n(),g(i,{key:2,class:"sm:max-w-[425px]"},{default:r(()=>[a(F,null,{default:r(()=>[a(p,null,{default:r(()=>[c("確認要預約這個座位嗎?")]),_:1}),a(k,{class:"text-red-500 font-bold"},{default:r(()=>[c(" 請確認以下的資料，送出後無法更改。 ")]),_:1})]),_:1}),u("div",xe,[a(v,null,{default:r(()=>[c(" 位置：第 "+w(t.data.group)+" 組 - "+w(t.data.number),1)]),_:1}),a(v,null,{default:r(()=>{var x;return[c(" 綽號："+w((x=t.user)==null?void 0:x.nick_name),1)]}),_:1}),a(v,null,{default:r(()=>{var x;return[c(" MBTI："+w((x=t.user)==null?void 0:x.mbti),1)]}),_:1})]),a(B,null,{default:r(()=>[a(D,{"as-child":""},{default:r(()=>[a(y,{onClick:o[1]||(o[1]=x=>{l(t.data.group,t.data.number,t.user.id)}),class:"bg-green-500 text-white px-4 py-1 rounded"},{default:r(()=>[c(" 確認 ")]),_:1})]),_:1}),a(D,{"as-child":""},{default:r(()=>[a(y,{variant:"outline"},{default:r(()=>[c(" 關閉 ")]),_:1})]),_:1})]),_:1})]),_:1})):(n(),g(i,{key:3,class:"sm:max-w-[425px]"},{default:r(()=>[a(F,null,{default:r(()=>[a(p,null,{default:r(()=>[c("請先登入。")]),_:1})]),_:1}),a(y,{variant:"outline",onClick:b.loginWithGoogle},{default:r(()=>[a(_,{name:"devicon:google"}),we]),_:1},8,["onClick"])]),_:1}))]}),_:1})):P("",!0),t.data.user_id===((A=t.user)==null?void 0:A.id)?(n(),g(y,{key:1,class:"bg-green-600 text-white px-4 py-1 rounded-full h-[40px] w-[75px]",disabled:""},{default:r(()=>{var C,x,z,N;return[u("div",be,[u("div",null,w((C=t.data.app_user)!=null&&C.nick_name?(x=t.data.app_user)==null?void 0:x.nick_name:"無"),1),u("div",null,w((z=t.data.app_user)!=null&&z.mbti?(N=t.data.app_user)==null?void 0:N.mbti:"無"),1)])]}),_:1})):t.data.status==="taken"?(n(),g(y,{key:2,class:"bg-sky-800 rounded-full h-[40px] w-[75px]",disabled:""},{default:r(()=>{var C,x,z,N;return[u("div",ke,[u("div",null,w((C=t.data.app_user)!=null&&C.nick_name?(x=t.data.app_user)==null?void 0:x.nick_name:"無"),1),u("div",null,w((z=t.data.app_user)!=null&&z.mbti?(N=t.data.app_user)==null?void 0:N.mbti:"無"),1)])]}),_:1})):t.data.status==="lock"?(n(),g(y,{key:3,variant:"secondary",class:"rounded-full h-[40px] w-[75px] bg-white",disabled:""})):P("",!0)])}}}),De={class:"flex flex-col gap-3 w-[300px]"},Be={class:"flex flex-row justify-center gap-3"},Ce={class:"flex flex-col gap-3"},Te={key:0,class:"w-[150px] border-2 flex place-content-center place-items-center"},Pe={key:1,class:"w-[150px] flex place-content-center place-items-center"},je={class:"flex flex-col gap-3"},Fe={class:"flex flex-row justify-center gap-3"},ze=$({__name:"group_table",props:{user:{},list:{},your_seat:{},data_refresh:{type:Function},personal_refresh:{type:Function}},setup(f){return(s,d)=>{const l=$e;return n(),m("div",De,[u("div",Be,[u("div",Ce,[a(l,{user:s.user,data:s.list[0],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"]),a(l,{user:s.user,data:s.list[1],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"])]),s.list[0].status!=="lock"?(n(),m("div",Te,"第"+w(s.list[0].group)+"組",1)):(n(),m("div",Pe)),u("div",je,[a(l,{user:s.user,data:s.list[2],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"]),a(l,{user:s.user,data:s.list[3],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"])])]),u("div",Fe,[a(l,{user:s.user,data:s.list[4],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"]),a(l,{user:s.user,data:s.list[5],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"]),a(l,{user:s.user,data:s.list[6],data_refresh:s.data_refresh,personal_refresh:s.personal_refresh,your_seat:s.your_seat},null,8,["user","data","data_refresh","personal_refresh","your_seat"])])])}}}),Ne={class:"flex flex-col gap-7"},Re={class:"container mx-auto px-4 flex flex-col gap-2"},Ee=ue('<div class="font-bold text-2xl">STP暑期黑馬營劃位</div><div class="flex flex-col gap-3"><div class="text-gray-500">此為黑馬營工作坊當日座位表，大家可以選擇自己喜歡的座位哦！</div><div class="text-gray-500">⚠️登入後，首先填寫基本資料，接著便可回首頁進行劃位！</div><div class="text-gray-500">⚠️為維護同學個人隱私，劃位表中僅會出現暱稱以及填答之MBTI，請放心作答～</div></div>',2),Ke={key:0,class:"flex flex-col gap-2"},Me={key:0,src:"https://images.plurk.com/7sDR5oYR30y1YfpYvbBpg5.png",class:"w-[1364px]"},Se={key:1,src:"https://images.plurk.com/3oagR5wkpo622Mf8NrNrp.png",class:"w-[1364px]"},Ie={key:2,src:"https://images.plurk.com/5nmKlgKPdXuUiCcLjdLHvR.jpg",class:"w-[1364px]"},Ae={key:3,src:"https://images.plurk.com/3xuQoP21F56d2etfm1nEVE.png",class:"w-[1364px]"},Oe={key:4,src:"https://images.plurk.com/1EcEKeTi9ycYfvaU0XKPEK.png",class:"w-[1364px]"},Ve=u("div",{class:"flex justify-center gap-5 text-gray-500"},"▲ 座位表",-1),Ge=u("div",{class:"border-2 h-[1px]"},null,-1),He={class:"container mx-auto overflow-x-auto"},Le={key:0,class:"flex flex-col gap-10"},Ue={class:"flex flex-row w-[1225px]"},Ye={class:"flex flex-col w-[100px] h-[60px]"},qe={class:"text-sm w-[100px] h-[20px]"},We={class:"text-sm w-[100px] h-[20px]"},Xe={class:"text-sm w-[100px] h-[20px]"},Je=u("div",{class:"flex flex-row gap-[50px] w-[1125px] justify-center"},[u("div",{class:"w-[350px] h-[60px] border-2 flex place-content-center place-items-center"},"投影幕"),u("div",{class:"w-[200px] h-[60px] border-2 flex place-content-center place-items-center"},"講台"),u("div",{class:"w-[350px] h-[60px] border-2 flex place-content-center place-items-center"},"投影幕")],-1),Qe={class:"flex flex-row gap-10"},Ze={class:"flex flex-row gap-10"},es={key:0,class:"flex flex-row gap-10"},ss={key:1,class:"flex flex-row gap-10"},as={key:0,class:"flex h-[50px] justify-center gap-5 text-gray-600"},is=$({__name:"index",setup(f){const s=U(),d=le(),{data:l,error:b,refresh:t}=E("get_user",async()=>{const{data:k,error:v}=await s.from("app_user").select("*").eq("id",d.value.id);return v?null:k[0]}),{data:o,error:y,refresh:h}=E("get_data",async()=>{const{data:k,error:v}=await s.from("seat").select("*, app_user(*)").order("number",{ascending:!0});if(v)return null;let D=[];const B=[];for(let _=1;_<=16;_++){for(let j=0;j<k.length;j++)k[j].group===_&&D.push(k[j]);B.push(D),D=[]}return B}),{data:p,error:F,refresh:i}=E("get_personal_data",async()=>{const{data:k,error:v}=await s.from("seat").select("*, app_user(*)").eq("user_id",d.value.id);return v?null:k});return ne(async()=>{await t(),await h(),await i()}),(k,v)=>{const D=q,B=O,_=ze;return n(),m("div",Ne,[a(D,{class:"px-2 md:px-4 sticky top-4 z-20"}),u("div",Re,[u("div",null,[Ee,e(d)?(n(),m("div",Ke,[e(o)&&e(o)[6][0].status==="lock"?(n(),m("img",Me)):e(o)&&e(o)[8][0].status==="lock"?(n(),m("img",Se)):e(o)&&e(o)[10][0].status==="lock"?(n(),m("img",Ie)):e(o)&&e(o)[12][0].status==="lock"?(n(),m("img",Ae)):(n(),m("img",Oe)),Ve])):P("",!0)]),Ge,u("div",He,[e(o)&&e(d)?(n(),m("div",Le,[u("div",Ue,[u("div",Ye,[u("div",qe,[a(B,{name:"ph:circle",style:{color:"rgb(0 0 0 / 0.5)"}}),c(" ：可預約 ")]),u("div",We,[a(B,{name:"ph:circle-duotone",style:{color:"rgb(22 163 74 / 0.5)"}}),c(" ：您的位置 ")]),u("div",Xe,[a(B,{name:"ph:circle-duotone",style:{color:"rgb(59 130 246 / 0.5)"}}),c(" ：已預約 ")])]),Je]),u("div",Qe,[a(_,{user:e(l),list:e(o)[0],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(l),list:e(o)[1],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(l),list:e(o)[2],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(l),list:e(o)[3],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"])]),u("div",Ze,[a(_,{user:e(l),list:e(o)[6],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(l),list:e(o)[4],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(l),list:e(o)[5],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(l),list:e(o)[7],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"])]),e(o)[8][0].status!=="lock"?(n(),m("div",es,[a(_,{user:e(l),list:e(o)[10],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(l),list:e(o)[8],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(l),list:e(o)[9],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(l),list:e(o)[11],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"])])):P("",!0),e(o)[12][0].status!=="lock"?(n(),m("div",ss,[a(_,{user:e(l),list:e(o)[14],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(l),list:e(o)[12],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(l),list:e(o)[13],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"]),a(_,{user:e(l),list:e(o)[15],data_refresh:e(h),personal_refresh:e(i),your_seat:e(p)},null,8,["user","list","data_refresh","personal_refresh","your_seat"])])):P("",!0)])):P("",!0)]),e(d)?P("",!0):(n(),m("div",as,"請登入以查看預約列表及進行預約服務。 "))])])}}});export{is as default};
