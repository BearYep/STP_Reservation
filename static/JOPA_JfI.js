import{_ as M}from"./XgzWlc3I.js";import{_ as k}from"./BTlQ66Qh.js";import{j as z,k as y,r as b,s as G,l as H,m as I,q as R,v as j,x as T,y as F,z as c,A as U,B as W,f as K,g as L,h as $,C as q,o as m,c as g,F as J,D as Q,d as x,b as D,w,E,G as B,t as O,a as V,n as X}from"./cLPuv5F0.js";const Y=s=>s==="defer"||s===!1;function Z(...s){var S;const r=typeof s[s.length-1]=="string"?s.pop():void 0;typeof s[0]!="string"&&s.unshift(r);let[e,u,a={}]=s;if(typeof e!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof u!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");const t=z(),f=u,_=()=>y.value,h=()=>t.isHydrating?t.payload.data[e]:t.static.data[e];a.server=a.server??!0,a.default=a.default??_,a.getCachedData=a.getCachedData??h,a.lazy=a.lazy??!1,a.immediate=a.immediate??!0,a.deep=a.deep??y.deep,a.dedupe=a.dedupe??"cancel";const p=()=>a.getCachedData(e,t)!=null;if(!t._asyncData[e]||!a.immediate){(S=t.payload._errors)[e]??(S[e]=y.errorValue);const i=a.deep?b:G;t._asyncData[e]={data:i(a.getCachedData(e,t)??a.default()),pending:b(!p()),error:H(t.payload._errors,e),status:b("idle"),_default:a.default}}const n={...t._asyncData[e]};delete n._default,n.refresh=n.execute=(i={})=>{if(t._asyncDataPromises[e]){if(Y(i.dedupe??a.dedupe))return t._asyncDataPromises[e];t._asyncDataPromises[e].cancelled=!0}if((i._initial||t.isHydrating&&i._initial!==!1)&&p())return Promise.resolve(a.getCachedData(e,t));n.pending.value=!0,n.status.value="pending";const d=new Promise((l,o)=>{try{l(f(t))}catch(P){o(P)}}).then(async l=>{if(d.cancelled)return t._asyncDataPromises[e];let o=l;a.transform&&(o=await a.transform(l)),a.pick&&(o=ee(o,a.pick)),t.payload.data[e]=o,n.data.value=o,n.error.value=y.errorValue,n.status.value="success"}).catch(l=>{if(d.cancelled)return t._asyncDataPromises[e];n.error.value=F(l),n.data.value=c(a.default()),n.status.value="error"}).finally(()=>{d.cancelled||(n.pending.value=!1,delete t._asyncDataPromises[e])});return t._asyncDataPromises[e]=d,t._asyncDataPromises[e]},n.clear=()=>A(t,e);const v=()=>n.refresh({_initial:!0}),C=a.server!==!1&&t.payload.serverRendered;{const i=U();if(i&&!i._nuxtOnBeforeMountCbs){i._nuxtOnBeforeMountCbs=[];const o=i._nuxtOnBeforeMountCbs;I(()=>{o.forEach(P=>{P()}),o.splice(0,o.length)}),R(()=>o.splice(0,o.length))}C&&t.isHydrating&&(n.error.value||p())?(n.pending.value=!1,n.status.value=n.error.value?"error":"success"):i&&(t.payload.serverRendered&&t.isHydrating||a.lazy)&&a.immediate?i._nuxtOnBeforeMountCbs.push(v):a.immediate&&v();const d=W();if(a.watch){const o=j(a.watch,()=>n.refresh());d&&T(o)}const l=t.hook("app:data:refresh",async o=>{(!o||o.includes(e))&&await n.refresh()});d&&T(l)}const N=Promise.resolve(t._asyncDataPromises[e]).then(()=>n);return Object.assign(N,n),N}function A(s,r){r in s.payload.data&&(s.payload.data[r]=void 0),r in s.payload._errors&&(s.payload._errors[r]=y.errorValue),s._asyncData[r]&&(s._asyncData[r].data.value=void 0,s._asyncData[r].error.value=y.errorValue,s._asyncData[r].pending.value=!1,s._asyncData[r].status.value="idle"),r in s._asyncDataPromises&&(s._asyncDataPromises[r]&&(s._asyncDataPromises[r].cancelled=!0),s._asyncDataPromises[r]=void 0)}function ee(s,r){const e={};for(const u of r)e[u]=s[u];return e}const ae=V("span",{class:"w-full"},"透過 Google 登入",-1),te={key:1},se=V("span",{class:"w-full"},"登出",-1),ie=K({__name:"index",setup(s){const r=L(),e=$(),{data:u,error:a}=Z("get_data",async()=>{const{data:f,error:_}=await r.from("reservation_list").select();return _?null:f}),t={async loginWithGoogle(){await r.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.protocol+"//"+window.location.host+"/auth/callback"}})}};return(f,_)=>{const h=M,p=k,n=q("Icon");return m(),g("div",null,[(m(!0),g(J,null,Q(c(u),(v,C)=>(m(),g("div",{key:C},[V("span",null,O(v.name),1)]))),128)),x(" 測試 "),D(p,{to:"a"},{default:w(()=>[D(h,null,{default:w(()=>[x(" 到下一頁 ")]),_:1})]),_:1}),c(e)?B("",!0):(m(),E(h,{key:0,class:"w-full flex",variant:"outline",onClick:t.loginWithGoogle},{default:w(()=>[D(n,{name:"devicon:google"}),ae]),_:1},8,["onClick"])),c(e)?(m(),g("div",te,O(c(e).id)+" , email: "+O(c(e).email),1)):B("",!0),c(e)?(m(),E(h,{key:2,class:"w-full flex",variant:"outline",onClick:_[0]||(_[0]=v=>("navigateTo"in f?f.navigateTo:c(X))("/logout"))},{default:w(()=>[D(n,{name:"devicon:google"}),se]),_:1})):B("",!0)])}}});export{ie as default};
